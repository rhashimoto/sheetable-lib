var a=[],p=new Map,i="ABCDEFGHIJKLMNOPQRSTUVWXYZ",g=26,x=g+26*26,b=x+26*26*26,I=class{properties={};sheets=[];addSheet(t){let n=new w;return t&&(n.properties.title=t),this.sheets.push(n),n}},w=class s{properties={};setGridValues(t,n){let r=typeof n=="function"?n:()=>n;this.setGridData(t,(e,u)=>{let o,l=r(e,u);switch(typeof l){case"string":l.startsWith("=")?o={formulaValue:l}:o={stringValue:l};break;case"number":o={numberValue:l};break;case"boolean":o={boolValue:l};break;default:break}return o?{userEnteredValue:o}:{}})}setGridData(t,n){typeof t=="string"?t=s.fromA1(t):d(t),t=Object.assign({columnCount:1,rowCount:1},t);let r={startRow:t.rowIndex,startColumn:t.columnIndex,rowData:[]};for(let u=0;u<t.rowCount;u++){let o={values:[]};for(let l=0;l<t.columnCount;l++){let c=n(l+t.columnIndex,u+t.rowIndex);o.values.push(c)}r.rowData.push(o.values.length?o:{})}this.data=this.data??[],this.data.push(r),this.properties.gridProperties||(this.properties.gridProperties={rowCount:0,columnCount:0});let e=this.properties.gridProperties;e.rowCount=Math.max(e.rowCount,t.rowIndex+t.rowCount),e.columnCount=Math.max(e.columnCount,t.columnIndex+t.columnCount)}getGridCell(t){if(typeof t=="string"?t=s.fromA1(t):d(t),!(t.rowIndex<this.properties.gridProperties?.rowCount)||!(t.columnIndex<this.properties.gridProperties?.columnCount))return null;for(let n of this.data?.toReversed()??[]){if(t.columnIndex<n.startColumn||t.rowIndex<n.startRow||t.rowIndex>=n.startRow+n.rowData.length)continue;let r=n.rowData[t.rowIndex-n.startRow];if(t.columnIndex<n.startColumn+r.values.length)return r.values[t.columnIndex-n.startColumn]}return{}}static toA1(t){d(t);let{columnIndex:n,rowIndex:r,columnCount:e,rowCount:u}=t,o=n+(e??0);o>g&&(C(),o>x&&A());let l=a[n],c=r+1;if(!u)return`${l}${c}`;let f=a[n+e-1],h=r+u;return`${l}${c}:${f}${h}`}static fromA1=function(){let t=/^([A-Za-z]{1,3})([1-9]\d*)(?::([A-Za-z]{1,3})([1-9]\d*))?$/;return function(n){let r=n.match(t);if(!r)throw new Error(`Invalid A1 address: ${n}`);let e=r[1],u=parseInt(r[2],10),o=r[3],l=r[4]&&parseInt(r[4],10);switch(o&&((o.lengh<e.length||o.length===e.length&&o<e)&&([e,o]=[o,e]),l<u&&([u,l]=[l,u])),(o??e).length){case 2:C();break;case 3:A();break}let c=p.get(e),f=u-1,h={rowIndex:f,columnIndex:c};return o&&(h.columnCount=p.get(o)-c+1,h.rowCount=l-f),h}}()};function D(){for(let s=0;s<i.length;s++){let t=a.length,n=i[s];a.push(n),p.set(n,t)}}D();function C(){if(!(a.length>=x))for(let s=0;s<i.length;s++){let t=i[s];for(let n=0;n<i.length;n++){let r=a.length,e=t+i[n];a.push(e),p.set(e,r)}}}function A(){if(!(a.length>=b)){C();for(let s=0;s<i.length;s++){let t=i[s];for(let n=0;n<i.length;n++){let r=t+i[n];for(let e=0;e<i.length;e++){let u=a.length,o=r+i[e];a.push(o),p.set(o,u)}}}}}function d(s){let{rowIndex:t,columnIndex:n,rowCount:r,columnCount:e}=s,u=m(t),o=m(n),l=r!==void 0,c=e!==void 0,f=!l||m(r),h=!c||m(e);if(!u||!o||!f||!h||l!==c)throw new Error(`Invalid address: ${JSON.stringify(s)}`)}function m(s){return s===(s|0)&&s>=0}export{w as Sheet,I as Spreadsheet};
//# sourceMappingURL=Spreadsheet.js.map
